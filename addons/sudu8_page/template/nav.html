{template 'common/header'}
<ul class="nav nav-tabs">
    <li {if $op == 'index'}class="active"{/if}><a href="{php echo $this->createWebUrl('nav', array('op' => 'index'))}">导航设置</a></li>
    <li {if $op == 'list'}class="active"{/if}><a href="{php echo $this->createWebUrl('nav', array('op' => 'list'))}">自定义导航</a></li>
    <li {if $op == 'post'}class="active"{/if}><a href="{php echo $this->createWebUrl('nav', array('op' => 'post'))}">添加自定义导航</a></li>
</ul>
<link rel="stylesheet" type="text/css" href="/addons/sudu8_page/static/js/colorpicker.css">
<script src="/addons/sudu8_page/static/js/colorpicker.js"></script>
<style>
.hide1{display: none}
.colorpicker{z-index: 999;}
</style>
<script>
$(function(){
  $('#colorSelector1').ColorPicker({
    color: '#0000ff',
    onShow: function (colpkr) {
        $(colpkr).fadeIn(500);
        return false;
    },
    onHide: function (colpkr) {
        $(colpkr).fadeOut(500);
        return false;
    },
    onChange: function (hsb, hex, rgb) {
        $('#colorSelector1 div').css('backgroundColor', '#' + hex);
        $('#title_color').val("#"+hex);
    }
  });
  $('#colorSelector2').ColorPicker({
    color: '#0000ff',
    onShow: function (colpkr) {
        $(colpkr).fadeIn(500);
        return false;
    },
    onHide: function (colpkr) {
        $(colpkr).fadeOut(500);
        return false;
    },
    onChange: function (hsb, hex, rgb) {
        $('#colorSelector2 div').css('backgroundColor', '#' + hex);
        $('#title_bg').val("#"+hex);
    }
  })
});
</script>
{if $op == 'index'}
<form class="form-horizontal" action="" method="post">
    <div class="panel panel-default">
        <div class="panel-heading">
             <h3 class="panel-title">栏目导航管理</h3>
        </div>
        <div class="panel-body">
            <div class="alert alert-warning" role="alert">请先添加栏目，再设置本导航，仅支持栏目跳转，如需（电话、导航、链接其他页面）等请设置自定义导航！</div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">导航栏目</label>
                <div class="form-controls col-sm-4">
                    <input type="text" name="url" value="{$item['url']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">请输入栏目的ID，并用英文,隔开，数量不限</div>
            </div>
            <div class="form-group" style="display: none">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">其他页面</label>
                <div class="form-controls col-sm-8 help-block">公司介绍【about】 微信【wechat】 表单【form】 电话【tel】 导航【address】</div>
            </div>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
             <h3 class="panel-title">导航自定义样式</h3>
        </div>
        <div class="panel-body">
            <div class="form-group">
                <input type="hidden" name="type" value="index" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">首页导航模块</label>
                <div class="form-controls col-sm-6">
                    <label style="margin-right: 20px">
                        <input type="radio" name="statue" value="0" {if $item['statue'] == '0'} checked{/if} />
                        不启用
                    </label>
                    <label style="margin-right: 20px">
                        <input type="radio" name="statue" value="1" {if $item['statue'] == '1'} checked{/if} />
                        启用栏目导航
                    </label>
                    <label style="margin-right: 20px">
                        <input type="radio" name="statue" value="2" {if $item['statue'] == '2'} checked{/if} />
                        启用自定义导航<span style="color: #f00; font-size: 12px; padding: 0 5px">NEW</span>
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">导航板块中文名称</label>
                <div class="form-controls col-sm-4">
                    <input type="text" name="name" value="{$item['name']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">中文名称</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">导航板块英文名称</label>
                <div class="form-controls col-sm-4">
                    <input type="text" name="ename" value="{$item['ename']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">英文名称</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">名称板块是否显示</label>
                <div class="form-controls col-sm-4">
                    <label style="margin-right: 20px">
                        <input type="radio" name="name_s" value="0" {if $item['name_s'] == '0'} checked{/if} />
                        显示
                    </label>
                    <label style="margin-right: 20px">
                        <input type="radio" name="name_s" value="1" {if $item['name_s'] == '1'} checked{/if} />
                        不显示
                    </label>
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">图标九宫格，建议设置不显示</div>
            </div>
            <div class="form-group" style="display: none;">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">导航样式</label>
                <div class="form-controls col-sm-4">
                    <label style="margin-right: 20px">
                        <input type="radio" name="style" value="1" {if $item['style'] == '1'} checked{/if} />
                        九宫格
                    </label>
                    <label style="margin-right: 20px">
                        <input type="radio" name="style" value="0" {if $item['style'] == '2'} checked{/if} />
                        横排
                    </label>
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">首页导航样式</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">导航上下边距</label>
                <div class="form-controls col-sm-4">
                    <input type="text" name="box_p_tb" value="{$item['box_p_tb']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">导航上下留白的间距，建议2</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">导航左右边距</label>
                <div class="form-controls col-sm-4">
                    <input type="text" name="box_p_lr" value="{$item['box_p_lr']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">导航左右边距和导航每块的间距，建议1</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">每排显示数量</label>
                <div class="form-controls col-sm-4">
                    <input type="text" name="number" value="{$item['number']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">请输入1 - 10，建议不超过5</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">图标占比</label>
                <div class="form-controls col-sm-4">
                    <input type="text" name="img_size" style="float:left;width: 87%;" value="{$item['img_size']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                    <div class="input-group-btn">
                        <button type="button" class="btn btn-default">%</button>
                    </div>
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">图标占比大小，写数字60，80，100</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">标题样式</label>
                <div class="form-controls col-sm-4">
                    <label style="display: block;">
                        <input type="radio" name="title_position" value="1" {if $item['title_position'] == '1'} checked{/if} />
                        文字在下方，无背景
                    </label>
                    <label style="display: block;">
                        <input type="radio" name="title_position" value="2" {if $item['title_position'] == '2'} checked{/if} />
                        文字在底部，半透明背景
                    </label>
                    <label style="display: block;">
                        <input type="radio" name="title_position" value="3" {if $item['title_position'] == '3'} checked{/if} />
                        文字左上角，半透明背景
                    </label>
                    <label style="display: block;">
                        <input type="radio" name="title_position" value="0" {if $item['title_position'] == '0'} checked{/if} />
                        文字不显示
                    </label>
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">导航每块标题样式</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">标题颜色</label>
                <div class="form-controls col-sm-4">
                    <div id="colorSelector1"><div style="width: 34px;height: 34px;background: {$item['title_color']};float: left;border: 1px solid #ccc;border-right: 0;"></div></div>
                    <input type="text" id="title_color" name="title_color" value="{$item['title_color']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off" style="width: 100px">
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">当导航标题显示时生效</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">标题背景颜色</label>
                <div class="form-controls col-sm-4">
                    <div id="colorSelector2"><div style="width: 34px;height: 34px;background: {$item['title_bg']};float: left;border: 1px solid #ccc;border-right: 0;"></div></div>
                    <input type="text" id="title_bg" name="title_bg" value="{$item['title_bg']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off" style="width: 100px">
                </div>
                <div class="col-sm-1"></div>
                <div class="form-controls col-sm-4 help-block">当标题在底部和左上角时生效</div>
            </div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-12">
            <input name="token" type="hidden" value="{$_W['token']}" />
            <input type="submit" class="btn btn-primary col-lg-1" name="submit" value="提交" />
        </div>
    </div>
</form>
{/if}
{if $op == 'list'}
<form class="form-horizontal" action="" method="post">
    <table class="table we7-table table-hover article-list vertical-middle">
        <tr>
            <td style="width:100px">排序</td>
            <td>栏目图片</td>
            <td>导航名称</td>
            <td>状态/类型</td>
            <td class="text-right">操作</td>
        </tr>
        {loop $list $item}
        <tr>
            <td>
                {$item['num']}
            </td>
            <td style="width: 100px">
                <img src="{media $item['pic']}" width="50px" alt="">
            </td>
            <td>
                <strong>{$item['title']}</strong>
            </td>
            <td>
                {if $item['flag']==0}
                            <span class='label label-danger'>关闭</span>
                        {elseif $item['flag']==1}
                            <span class='label label-success'>开启</span>
                        {/if} 
                        - 
                        {if $item['type']==0}
                            <span class='label label-primary'>小程序页面</span>
                        {elseif $item['type']==1}
                            <span class='label label-primary'>拨打电话</span>
                        {elseif $item['type']==2}
                            <span class='label label-primary'>一键导航</span>
                        {elseif $item['type']==3}
                            <span class='label label-primary'>微信客服</span>
                        {elseif $item['type']==4}
                            <span class='label label-primary'>打开小程序</span>
                        {elseif $item['type']==5}
                            <span class='label label-primary'>打开网页</span>
                        {/if}
            </td>
            <td class="text-right">
                <a class="btn btn-default btn-sm" href="{php echo $this->createWeburl('nav', array('id' => $item['id'], 'op' =>'post'))}" >编辑</a>
                <a class="btn btn-default btn-sm" onclick="return confirm('此操作不可恢复，确认吗？'); return false;" href="{php echo $this->createWeburl('nav', array('id' => $item['id'], 'op' => 'delete'))}">删除</a>
            </td>
        </tr>
        {/loop}
    </table>
</form>
{/if}
{if $op == 'post'}
<form class="form-horizontal" action="" method="post">
        <div class="alert alert-success" role="alert">
            <p>小程序链接说明：<a href="https://shimo.im/docs/fbETPHyU5P8dR9pD" target="_blank">点击查看</a></p>
        </div>
        <div class="panel panel-default">
        <div class="panel-heading">
             <h3 class="panel-title">自定义导航</h3>
        </div>
        <div class="panel-body">
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">排序</label>
                <div class="form-controls col-sm-5" style="padding-right: 30px;">
                    <input type="text" name="num" id="num" value="{$item['num']}" style="width: 100px" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                </div>
                <div class="form-controls col-sm-4 help-block">序号越大越靠前</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">启用</label>
                <div class="form-controls col-sm-5" style="padding-right: 30px;">
                    <label style="margin-right: 20px">
                        <input type="radio" name="flag" value="1" {if $item['flag'] == '1'} checked{/if} />
                        启用
                    </label>
                    <label style="margin-right: 20px">
                        <input type="radio" name="flag" value="0" {if $item['flag'] == '0'} checked{/if} />
                        不启用
                    </label>
                </div>
                <div class="form-controls col-sm-4 help-block">启用后，栏目其他设置方可生效</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">类型</label>
                <div class="form-controls col-sm-5" style="padding-right: 30px;">
                    <select name="type" class="form-control"  id="catetype" onchange="change_catetype()">
                        <option value="" >--请选择--</option>
                        <option value="0" {if $item['type']==0}selected{/if} >小程序页面</option>
                        <option value="1" {if $item['type']==1}selected{/if} >拨打电话</option>
                        <option value="2" {if $item['type']==2}selected{/if} >打开导航</option>
                        <option value="3" {if $item['type']==3}selected{/if} >微信客服</option>
                        <option value="4" {if $item['type']==4}selected{/if} >打开小程序</option>
                        <option value="5" {if $item['type']==5}selected{/if} >打开网页</option>
                    </select>
                </div>
                <div class="form-controls col-sm-4 help-block" style="color: #c00">请选择功能</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">导航图标</label>
                <div class="form-controls col-sm-5" style="padding-right: 30px;">
                    {php echo tpl_form_field_image('pic', $item['pic'])}
                </div>
                <div class="form-controls col-sm-4 help-block">可用正方形，长方形等，确保大小一致</div>
            </div>
            <div class="form-group">
                <label for="" class="control-label col-sm-2" style="margin-right:45px">导航标题</label>
                <div class="form-controls col-sm-5" style="padding-right: 30px;">
                    <input type="text" name="title" value="{$item['title']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                </div>
                <div class="form-controls col-sm-4 help-block"></div>
            </div>
            <div class="form-group url1" {if $item['type']==2}style="display:none"{/if} {if $item['type']==3}style="display:none"{/if}>
                <label for="" class="control-label col-sm-2" id="url1" style="margin-right:45px">
                {if $item['type']==0}小程序页面地址{/if}
                {if $item['type']==1}电话号码{/if}
                {if $item['type']==4}小程序appid{/if}
                {if $item['type']==5}https网址{/if}
                </label>
                <div class="form-controls col-sm-5" style="padding-right: 30px;">
                    <input type="text" name="url" value="{$item['url']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                </div>
                <div class="form-controls col-sm-4 help-block" id="notice">
                {if $item['type']==1}不填则为基础设置里的电话{/if}
                {if $item['type']==5}必须要加到业务域名{/if}
                </div>
            </div>
            <div class="form-group hide1" {if $item['type']==4}style="display:block"{/if}>
                <label for="" class="control-label col-sm-2" style="margin-right:45px">
                小程序页面路径
                </label>
                <div class="form-controls col-sm-5" style="padding-right: 30px;">
                    <input type="text" name="url2" value="{$item['url2']}" class="form-control ng-pristine ng-untouched ng-valid ng-empty"  placeholder="" autocomplete="off">
                </div>
                <div class="form-controls col-sm-4 help-block"></div>
            </div>
        </div>
    </div>

    <div class="form-group">
        <div class="col-sm-12">
            <input name="token" type="hidden" value="{$_W['token']}" />
            <input type="submit" class="btn btn-primary col-lg-1" name="submit" value="提交" />
        </div>
    </div>
</form>
<script>
    function change_catetype(){
        var p1=$('#catetype').children('option:selected').val();
        if(p1 == 0){
            $("#url1").text("小程序页面地址");
            $(".url1").show();
            $(".hide1").hide();
            $("#notice").hide();
        }
        if(p1 == 1){
            $("#url1").text("电话号码");
            $(".url1").show();
            $(".hide1").hide();
            $("#notice").show();
            $("#notice").text("不填则为基础设置里的电话");
        }
        if(p1 == 2){
            $(".url1").hide();
            $(".hide1").hide();
            $("#notice").hide();
        }
        if(p1 == 3){
            $(".url1").hide();
            $(".hide1").hide();
            $("#notice").hide();
        }
        if(p1 == 4){
            $("#url1").text("小程序appid");
            $(".url1").show();
            $(".hide1").show();
            $("#notice").hide();
        }
        if(p1 == 5){
            $("#url1").text("https网址");
            $(".hide1").hide();
            $("#notice").show();
            $("#notice").text("必须要加到业务域名");
        }
    }
</script>
{/if}
{template 'common/footer'}
{template 'common/header'}
{php load()->func('tpl');}
<div class="main">
        <div class="panel panel-default">
            <div class="panel-heading">
                使用必读
            </div>
            <div class="panel-body">
<div class="form-group clearfix">
　　1.使用前请进行密码部署,否则无法使用；<br>
　　2.请一定要存好《密码部署》纸质文档，并做好纸质的《防伪码生成台账》；<br>
　　3.如果要在公众号菜单中加个扫码功能,则关键字一栏请填“微防伪”；<br>
　　4.未认证的公众号权限太低，请用“微信回复方案”，而且只能单纯防伪，其它数据分析不能完成，建议用已认证的公众号做接入。<br>
　　5.防伪标在印刷前一定要生成几个相同类型的演示码测试，确认能通过时方可下单印刷，切记！切记！<br>
　　6.如果你是认证的公众号，但在查询界面又没有客户的头像等资料的，<a href='./index.php?c=mc&a=passport&do=sync&'>请点这里查看是否开通会员资料同步！</a><br>



<br>
		  </div> 	
    </div>
</div>


 {if $_W['role'] == "founder" }
 <div class="main">
        <div class="panel panel-default">
            <div class="panel-heading">
                版本说明（以下内容只有站长可见）
            </div>
            <div class="panel-body">
<div class="form-group clearfix">
　　一、因各公众号所赋予的权限不同,在查询时的设置也有些不同<br><br>
　　1.认证服务号(推荐)，这类公众号权限最高能支持动态防伪二维码，所以扫码流程和统计管理都能有最优的体验；<br><br>
　　2.认证订阅号，这类公众号不能支持动态防伪二维码，不能支持模板消息，所以其对没关注的客户扫码流程有点变化（就是扫码后关注公众号，此时已经进入公众号，再从公众号菜单上点扫码重扫，流程顺只是要扫两次，已经关注的就只扫一次就行），还有，不支持厂家模板消息通知；<br><br>
　　3.未认证服务号，这类的扫码流程和上面相同，也不支持厂家模板消息通知，不支持获取客户资料，只能做单纯的二维码防伪；<br><br>
　　4.未认证订阅号 这类没有扫码权限，只能用公众号回复的方式查询，只能做单纯的防伪；<br><br>
　　5.如果设置成全网通查方案，则可实现全部公众号都能扫一扫查询，并且只扫一次就能出结果，但没认证的公众号还是不能收集客户资料；<br><br>
　　总之如果是新注册的公众号肯定首选《认证服务号》其它方案只是在实在没有认证服务号时候的备用方案。<br><br>
　　二、微防伪所有功能都能自定义开关，所有回复内容都能自定义内容，所有前端都能自定义模板，也就是一个前端完全开放，自由配置的模块，发挥你的创造思维你一定能做出级个性化的防伪界面，还可以为每个公众号定制不同的前端模板，通过查询后引导链接，你可以引导客户做任何想做的事，如外部的抽奖模块(微赞原生就有：大转盘，摇骰子，打气球，砸蛋...)、调研、投票、商城，也可以是分销商下线，总之你客户想搞什么活动你就帮他配置什么。总之微防伪控制的是防伪内核，前端的一切任你配置.这个模块到手后你应该多多研究，当你玩熟了你一定能发现他的强大。<br><br>


	
</div> 	

        </div> 
 </div>  </div> 
 
  <div class="main">
        <div class="panel panel-default">
            <div class="panel-heading">
                更新日志（以下内容只有站长可见）
            </div>
            <div class="panel-body">
<div class="form-group clearfix">
==================2015-10-20(0.9.5)================<br>
<b>重大新增：数据魔方(报表中心)</b><br>
新增：红包余额不足模板消息提醒<br>
调整：公众号是否有生成防伪码数据包权限,由站长决定<br>
调整：重新定义商品的Banner图为图文查询的主图<br>
调整：加长密码部署的批次位数(超过8位需站长设置)<br>
修复：修复若干小错<br>
/////////////以下语句是为了优化报表生成效率,非必要,选择性运行(2015.10.20后安装的已经内置请忽略)///////////<br>
ALTER TABLE `ims_zmcn_fw_chai` ADD INDEX(`userid`); <br>
ALTER TABLE `ims_zmcn_fw_chai` ADD INDEX(`province`); <br>
ALTER TABLE `ims_zmcn_fw_chai` ADD INDEX(`city`);<br>
ALTER TABLE `ims_zmcn_fw_chai` ADD INDEX(`gender`); <br>
ALTER TABLE `ims_zmcn_fw_chai` ADD INDEX(`type`); <br>
//////////////////////////////////////////////////////////////////////////////////////////////////////	<br>
==================2015-11-02(0.9.8)================<br>
<b>重大新增：实物礼品发放</b><br>
<b>重大新增：客户管理</b><br>
<b>重大调整：调整抽奖规则实现多样奖品随机发放</b><br>
新增：微信商品视频<br>
新增：微信服务器IP判断，精准分析是否为用户IP<br>
新增：全局广告位和批次广告位<br>
新增：支持自定义防伪码生成次序<br>
增强：商品快速录入<br>
调整：批次管理届面<br>
调整：手机端界面<br>
调整：手机端WAP界面<br>
调整：重新定义商品主图和视频<br>
调整：红包发放不成功时会自动改送等额余额<br>
修复：修复若干小错<br>
//////////////////////////////////////////////////////////////////////////////////////////////////////	<br>
==================2015-11-10(0.9.9)================<br>
调整：扫码提示语，完美支持防伪码和活动二维码<br>
调整：告示内容可以设置里面设<br>
修复：修复若干小错<br>
==================2015-11-18(1.0.0)================<br>
<b>重大新增：商品溯源</b><br>
<b>重大新增：各批次独立强大的活动功能</b><br>
<b>重大新增：活动批次管理</b><br>
调整：优化活动码提示语<br>
修复：红包发放提示金额不对<br>
修复：修复若干小错<br>
==================2015-11-23(1.0.2)================<br>
调整：优化卡劵发放<br>
调整：细节化批次管理<br>
修复：修复若干小错<br>
==================2015-11-28(1.2)================<br>
<b>重大新增：防伪码官网(WEB网站)查询API接口 (同时具备能生成 扫码 和 官网 两用防伪标 的数据包)</b><br>
<b>重大新增：防伪码多平台扫码接口（支持大部分扫码软件扫码查询，需手动配置）</b><br>
<b>重大新增：扫码粉丝会员自动分组功能</b><br>
调整：优化红包发放机制<br>
优化：优化头像显示<br>
==================2015-12-02(1.2.1)================<br>
调整：优化全网通查方案达到微信和其它扫码平台全兼容<br>
修复：修复若干小错<br>
==================2015-12-09(1.2.3)================<br>
新增：更多自定回复设置<br>
新增：自己定义字段和商品溯源的快捷录入<br>
优化：优化后台头像显示<br>
调整：优化全网通查方案达到微信和其它扫码平台全兼容<br>
修复：修复若干小错<br>
==================2015-12-30(1.2.4)================<br>
新增：溯源功能对接主管单位网站<br>
新增：对接多种介绍页面<br>
优化：活动连接接口新增接口加密功能能自开发多种活动应用<br>
调整：各种项目名称完全自定义支持多场景拓展<br>
==================2016-1-25(1.2.5)================<br>
新增：扫码后给出防伪信息，同时要求输入口令（可以是手机号码）等领取红包<br>
新增：精细化串货信息提示设置<br>
新增：关注页面背景图片设置(请选23号模板)<br>
优化：扫码查询体验，做到支持所有公众号，并且一扫一次就得结果<br>
优化：精细化全网通查接口，将设置具体到公众号，增加对QQ，快拍等工具识别<br>
==================2016-1-26(1.2.6)================<br>
新增：微站查询页面自定义防伪标图样<br>
==================2016-5-4(1.2.8)================<br>
新增：扫码和得奖黑白名单<br>
新增：店员管理<br>
修复：修复若干小错<br>
==================2016-5-4(1.3.0)================<br>
优化：细节优化<br>
修复：修复某个格式发红包漏洞<br>
修复：修复黑白名单小错<br>
==================2016-6-21(1.3.2)================<br>
新增：新增至对接8个商城<br>
新增：两个商品字段<br>
新增：高仿微信扫一扫的扫码流程<br>


</div> 	

        </div> 
 </div>  </div> 
 
 
 
 
   <div class="main">
        <div class="panel panel-default">
            <div class="panel-heading">
                微防伪官网查询接口API开发文档
            </div>
            <div class="panel-body">
<div class="form-group clearfix">
<b>服务器端设置：</b><br>
授权IP ：一个公众号只能授权一个IP 并只能通过该IP进行API通信（如果是同一内网的，可授权内网IP通信更快）<br>
通信密钥：通信鉴权专用（大于30位的随机字符串）<br>
这两个只要缺一个以上 都视为 API接口关闭<br>
<b>客户端设置（官网）</b><br>
通信密钥：通信鉴权专用（大于30位的随机字符串）<br>
==========================================================================<br>
<b>传入数据：</b><br>
$post = array(<br>
	'c'		=> 'entry',		//固定传入参数（不得改动）<br>
	'do'	=> 'a',			//固定传入参数（不得改动）<br>
	'm'		=> 'zmcn_fw',	//固定传入参数（不得改动）<br>
	'i'		=> '{$_W['uniacid']}',	//变量传入--公众号ID（这个数字就是当前公众号ID，可直接用）<br>
	'co'	=> 'FW12345',	//变量传入--防伪码<br>
	'ip'	=> '0.0.0.0',	//变量传入--客户IP（浏览网页之人IP，用于记录查询者地区）<br>
	'ke'	=> MD5(i.co.ip.key),//加密鉴权（注意按示例排序）<br>
);	<br>
将该数据包POST到：{$_W['siteroot']}app/index.php <br>
===========================================================================<br>
<b>正确返回数据：</b><br>
$content = array(<br>
	'content' => 0 ,	//正确返回代码<br>
	'no' => 2 ,			//该防伪码第几次查询<br>
	'co' => 'FW12345',	//被查防伪码<br>
	'pro' => array(<br>
		'name' => '商品名称',<br>
		'pic' => '{$_W['attachurl']}images/123.jpg', 	//商品主图<br>
		'link' => 'http://xxxx.xxx.xxx/xxx',						//购买链接<br>
	),<br>
	'title' => '查询成功，该码首次查询，请放心使用！',	//结果<br>
	'text' => array(),	//商品详情text[0],text[1],text[2],text[3]一项一条<br>
	'source' => array(),	//商品溯源source[0],source[1],source[2],source[3]一项一条<br>
	'history' => array(),	//查询记录history[0],history[1],history[2],history[3]一项一条<br>
 );<br>
===========================================================================<br>
<b>错误返回代码：</b><br>
1888：服务器API接口关闭<br>
1839：非授权IP<br>
1877：防伪码格式不对<br>
1876：加密串格式不对<br>
1875：加密鉴权失败<br>
1899：防伪码验证错误<br>
1866：没有该批次或批号出错<br>
===========================================================================<br>
<b>全网通查配置方法：</b><br>
请在系统根目录下的《 f.php 》文件里配置<br>
开通全网通查后：<br>
1.如果用户是用微信查询的将走正常的微信查询流程；<br>
2.如果用户是用其它工具查询的将会走全网查询流程；<br>
这两种流程系统会自己动判断和调用！<br>
但建议还是只开微信，毕竟用微信还能吸粉，开通全网通查后就会有一些非微信粉丝的查询记录。<br>
<br>
再加上WEB网站 API 接口....<br>
===========================================================================<br>
<b>活动外链接口开发文档：</b><br>
活动外链接口会传递两个参数，一个是当次防伪码[FWM]，一个是加了密的鉴权码[KEY]<br>
外部模块在收到这两个参数后，应该对传入的房伪码进行加权验证如果正确的可进入逻辑运算，同时对这个防伪码做个计数记录判断<br>
连接密钥是美个连接独立设置，方便对接多方面的模块。<br>
鉴权码的算法是 [KEY]=MD5("aaaaabbbbb");  [a是防伪码，b是连接密钥]<br>
防伪页面通过设置活动的显示规则来控制用户是否参加，外部模块通过对防伪码的计数来判断如何活动！<br>
如果是站内模块还可通过对防伪查询记录的复核判断是否真实有该防伪码，以及具体用户等更高级的判别。<br>






</div> 	

        </div> 
 </div>  </div> 
 
 
 
 
 
 
 
 
 
{/if} 







{template 'common/footer'}